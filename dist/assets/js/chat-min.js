class Chatroom{constructor(t,s){this.room=t,this.username=s,this.chats=db.collection("chats"),this.unsub}async addToChat(t){const s=new Date,e={message:t,username:this.username,room:this.room,created_at:firebase.firestore.Timestamp.fromDate(s)};return await this.chats.add(e)}getChats(t){this.unsub=this.chats.where("room","==",this.room).orderBy("created_at").onSnapshot(s=>{s.docChanges().forEach(s=>{"added"===s.type&&t(s.doc.data())})})}updateName(t){this.username=t,localStorage.setItem("username",t)}updateRoom(t){this.room=t,console.log(`room updated to ${t}`),this.unsub&&this.unsub()}}